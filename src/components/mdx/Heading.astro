---
interface Props {
  level: 1 | 2 | 3 | 4 | 5 | 6;
}

const { level } = Astro.props;

// Get the text content from the slot
const slotContent = await Astro.slots.render("default");
const textContent = slotContent.replace(/<[^>]*>/g, "").trim();

function slugify(str: string): string {
  if (!str) return "";
  return str
    .toString()
    .toLowerCase()
    .trim()
    .replace(/\s+/g, "-")
    .replace(/&/g, "-and-")
    .replace(/[^\w-]+/g, "")
    .replace(/--+/g, "-");
}

const slug = slugify(textContent);
const Tag = `h${level}` as "h1" | "h2" | "h3" | "h4" | "h5" | "h6";
---

<a href={`#${slug}`} class="no-underline">
  <Tag id={slug} class="anchor">
    <slot />
  </Tag>
</a>
